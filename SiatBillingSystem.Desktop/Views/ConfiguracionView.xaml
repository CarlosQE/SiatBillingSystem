<UserControl x:Class="SiatBillingSystem.Desktop.Views.ConfiguracionView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             Background="{StaticResource BgPrimary}">

    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <StackPanel Margin="16" MaxWidth="700" HorizontalAlignment="Left">

            <!-- SECCIÃ“N 1: Datos de la Empresa -->
            <Border Style="{StaticResource CardBorder}" Margin="0,0,0,12">
                <StackPanel>
                    <TextBlock Text="DATOS DE LA EMPRESA" Style="{StaticResource SectionHeader}"
                               Margin="0,0,0,14"/>

                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="160"/>
                        </Grid.ColumnDefinitions>

                        <StackPanel Grid.Column="0" Margin="0,0,12,0">
                            <TextBlock Text="RazÃ³n Social" Style="{StaticResource FieldLabel}"/>
                            <TextBox Style="{StaticResource PosTextBox}" Margin="0,0,0,10"
                                     Text="{Binding RazonSocial, UpdateSourceTrigger=PropertyChanged}"/>
                        </StackPanel>

                        <StackPanel Grid.Column="1">
                            <TextBlock Text="NIT" Style="{StaticResource FieldLabel}"/>
                            <TextBox Style="{StaticResource PosTextBox}" Margin="0,0,0,10"
                                     Text="{Binding Nit, UpdateSourceTrigger=PropertyChanged}"/>
                        </StackPanel>
                    </Grid>

                    <TextBlock Text="Actividad EconÃ³mica (CAEB)" Style="{StaticResource FieldLabel}"/>
                    <TextBox Style="{StaticResource PosTextBox}" Margin="0,0,0,10"
                             Width="200" HorizontalAlignment="Left"
                             Text="{Binding ActividadEconomica, UpdateSourceTrigger=PropertyChanged}"/>

                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="160"/>
                            <ColumnDefinition Width="160"/>
                        </Grid.ColumnDefinitions>

                        <StackPanel Grid.Column="0" Margin="0,0,12,0">
                            <TextBlock Text="CÃ³digo Sucursal" Style="{StaticResource FieldLabel}"/>
                            <TextBox Style="{StaticResource PosTextBoxNumber}"
                                     Text="{Binding CodigoSucursal, UpdateSourceTrigger=PropertyChanged}"/>
                        </StackPanel>

                        <StackPanel Grid.Column="1">
                            <TextBlock Text="Punto de Venta" Style="{StaticResource FieldLabel}"/>
                            <TextBox Style="{StaticResource PosTextBoxNumber}"
                                     Text="{Binding CodigoPuntoVenta, UpdateSourceTrigger=PropertyChanged}"/>
                        </StackPanel>
                    </Grid>
                </StackPanel>
            </Border>

            <!-- SECCIÃ“N 2: Certificado Digital -->
            <Border Style="{StaticResource CardBorder}" Margin="0,0,0,12">
                <StackPanel>
                    <TextBlock Text="CERTIFICADO DIGITAL" Style="{StaticResource SectionHeader}"
                               Margin="0,0,0,14"/>

                    <TextBlock Text="Archivo .p12 / .pfx (ADSIB o DigiCert)"
                               Style="{StaticResource FieldLabel}"/>

                    <Grid Margin="0,0,0,10">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <TextBox Grid.Column="0" Style="{StaticResource PosTextBox}"
                                 IsReadOnly="True" Margin="0,0,8,0"
                                 Text="{Binding RutaCertificado}"/>
                        <Button Grid.Column="1" Style="{StaticResource BtnSecondary}"
                                Height="36" Padding="12,0"
                                Content="ðŸ“‚ Examinar"
                                Command="{Binding SeleccionarCertificadoCommand}"/>
                    </Grid>

                    <TextBlock Text="ContraseÃ±a del Certificado" Style="{StaticResource FieldLabel}"/>
                    <PasswordBox Style="{StaticResource PosPasswordBox}"
                                 Width="300" HorizontalAlignment="Left"
                                 Margin="0,0,0,10"/>

                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <Border Grid.Column="0" Padding="10,6" CornerRadius="6"
                                Background="{StaticResource BgSecondary}"
                                BorderBrush="{StaticResource BorderColor}" BorderThickness="1">
                            <TextBlock Text="{Binding EstadoCertificado}"
                                       Style="{StaticResource BodyText}"/>
                        </Border>

                        <Button Grid.Column="1" Margin="10,0,0,0"
                                Style="{StaticResource BtnOutline}"
                                Height="36" Padding="12,0"
                                Content="âœ“ Validar"
                                Command="{Binding ValidarCertificadoCommand}"/>
                    </Grid>
                </StackPanel>
            </Border>

            <!-- SECCIÃ“N 3: ConexiÃ³n SIAT -->
            <Border Style="{StaticResource CardBorder}" Margin="0,0,0,16">
                <StackPanel>
                    <TextBlock Text="CONEXIÃ“N SIAT" Style="{StaticResource SectionHeader}"
                               Margin="0,0,0,14"/>

                    <TextBlock Text="Ambiente" Style="{StaticResource FieldLabel}"/>
                    <ComboBox Style="{StaticResource PosComboBox}"
                              Width="200" HorizontalAlignment="Left"
                              Margin="0,0,0,10"
                              SelectedValue="{Binding AmbienteSiat}">
                        <ComboBoxItem Content="Piloto (Pruebas)" Tag="Piloto" IsSelected="True"/>
                        <ComboBoxItem Content="ProducciÃ³n" Tag="Produccion"/>
                    </ComboBox>

                    <CheckBox Foreground="{StaticResource TextPrimary}"
                              FontFamily="Segoe UI" FontSize="12"
                              IsChecked="{Binding ModoOfflineForzado}"
                              Content="Forzar modo offline (no enviar al SIN)"
                              Margin="0,0,0,4"/>

                    <TextBlock Style="{StaticResource FooterLabel}" TextWrapping="Wrap"
                               Text="En modo offline las facturas se guardan localmente y se sincronizan cuando haya conexiÃ³n."/>
                </StackPanel>
            </Border>

            <!-- BotÃ³n Guardar + Mensaje -->
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Left">
                <Button Style="{StaticResource BtnPrimary}" Height="42" Padding="24,0"
        Margin="0,0,12,0"
        Content="ðŸ’¾ Guardar ConfiguraciÃ³n"
        Command="{Binding GuardarConfiguracionCommand}"/>

                <Border Padding="12,0" CornerRadius="6" VerticalAlignment="Center"
                        Visibility="{Binding GuardadoExitoso, Converter={StaticResource BoolToVisibility}}"
                        Background="#1A22C55E">
                    <TextBlock Text="{Binding MensajeEstado}"
                               Foreground="{StaticResource Success}"
                               FontSize="12" VerticalAlignment="Center"/>
                </Border>
            </StackPanel>

        </StackPanel>
    </ScrollViewer>
</UserControl>