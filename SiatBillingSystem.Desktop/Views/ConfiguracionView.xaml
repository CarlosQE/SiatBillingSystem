<UserControl x:Class="SiatBillingSystem.Desktop.Views.ConfiguracionView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             Background="{StaticResource BgPrimary}">

    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <StackPanel Margin="24" MaxWidth="720" HorizontalAlignment="Left">

            <!-- SECCIÃ“N 1: Datos de la Empresa -->
            <Border Style="{StaticResource CardBorder}" Margin="0,0,0,14">
                <StackPanel>
                    <TextBlock Text="DATOS DE LA EMPRESA"
                               FontFamily="Segoe UI Semibold" FontSize="11"
                               Foreground="{StaticResource BrandGray}"
                               Margin="0,0,0,14"/>

                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="16"/>
                            <ColumnDefinition Width="160"/>
                        </Grid.ColumnDefinitions>

                        <StackPanel Grid.Column="0">
                            <TextBlock Text="RazÃ³n Social" Style="{StaticResource FieldLabel}"/>
                            <TextBox Style="{StaticResource PosTextBox}"
                                     Text="{Binding RazonSocial, UpdateSourceTrigger=PropertyChanged}"/>
                        </StackPanel>

                        <StackPanel Grid.Column="2">
                            <TextBlock Text="NIT" Style="{StaticResource FieldLabel}"/>
                            <TextBox Style="{StaticResource PosTextBox}"
                                     Text="{Binding Nit, UpdateSourceTrigger=PropertyChanged}"/>
                        </StackPanel>
                    </Grid>

                    <TextBlock Text="Actividad EconÃ³mica (CAEB)"
                               Style="{StaticResource FieldLabel}" Margin="0,10,0,4"/>
                    <TextBox Style="{StaticResource PosTextBox}"
                             Width="220" HorizontalAlignment="Left"
                             Text="{Binding ActividadEconomica, UpdateSourceTrigger=PropertyChanged}"/>

                    <Grid Margin="0,10,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="160"/>
                            <ColumnDefinition Width="16"/>
                            <ColumnDefinition Width="160"/>
                        </Grid.ColumnDefinitions>

                        <StackPanel Grid.Column="0">
                            <TextBlock Text="CÃ³digo Sucursal" Style="{StaticResource FieldLabel}"/>
                            <TextBox Style="{StaticResource PosTextBoxNumber}"
                                     Text="{Binding CodigoSucursal, UpdateSourceTrigger=PropertyChanged}"/>
                        </StackPanel>

                        <StackPanel Grid.Column="2">
                            <TextBlock Text="Punto de Venta" Style="{StaticResource FieldLabel}"/>
                            <TextBox Style="{StaticResource PosTextBoxNumber}"
                                     Text="{Binding CodigoPuntoVenta, UpdateSourceTrigger=PropertyChanged}"/>
                        </StackPanel>
                    </Grid>
                </StackPanel>
            </Border>

            <!-- SECCIÃ“N 2: Certificado Digital -->
            <Border Style="{StaticResource CardBorder}" Margin="0,0,0,14">
                <StackPanel>
                    <TextBlock Text="CERTIFICADO DIGITAL"
                               FontFamily="Segoe UI Semibold" FontSize="11"
                               Foreground="{StaticResource BrandGray}"
                               Margin="0,0,0,14"/>

                    <TextBlock Text="Archivo .p12 / .pfx (ADSIB o DigiCert)"
                               Style="{StaticResource FieldLabel}"/>

                    <Grid Margin="0,0,0,10">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="8"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <TextBox Grid.Column="0" Style="{StaticResource PosTextBox}"
                                 IsReadOnly="True"
                                 Text="{Binding RutaCertificado}"/>
                        <Button Grid.Column="2" Style="{StaticResource BtnSecondary}"
                                Height="38" Padding="14,0"
                                Content="ðŸ“‚ Examinar"
                                Command="{Binding SeleccionarCertificadoCommand}"/>
                    </Grid>

                    <TextBlock Text="ContraseÃ±a del Certificado" Style="{StaticResource FieldLabel}"/>
                    <PasswordBox Style="{StaticResource PosPasswordBox}"
                                 Width="300" HorizontalAlignment="Left"
                                 Margin="0,0,0,12"/>

                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="8"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <Border Grid.Column="0" Padding="12,8" CornerRadius="6"
                                Background="{StaticResource BgSecondary}"
                                BorderBrush="{StaticResource BorderColor}" BorderThickness="1">
                            <TextBlock Text="{Binding EstadoCertificado}"
                                       FontFamily="Segoe UI" FontSize="12"
                                       Foreground="{StaticResource TextLight}"/>
                        </Border>

                        <Button Grid.Column="2" Style="{StaticResource BtnOutline}"
                                Height="38" Padding="14,0"
                                Content="âœ“ Validar"
                                Command="{Binding ValidarCertificadoCommand}"/>
                    </Grid>
                </StackPanel>
            </Border>

            <!-- SECCIÃ“N 3: ConexiÃ³n SIAT -->
            <Border Style="{StaticResource CardBorder}" Margin="0,0,0,20">
                <StackPanel>
                    <TextBlock Text="CONEXIÃ“N SIAT"
                               FontFamily="Segoe UI Semibold" FontSize="11"
                               Foreground="{StaticResource BrandGray}"
                               Margin="0,0,0,14"/>

                    <TextBlock Text="Ambiente" Style="{StaticResource FieldLabel}"/>
                    <ComboBox Style="{StaticResource PosComboBox}"
                              Width="220" HorizontalAlignment="Left"
                              Margin="0,0,0,12"
                              SelectedValue="{Binding AmbienteSiat}">
                        <ComboBoxItem Content="Piloto (Pruebas)" Tag="Piloto"/>
                        <ComboBoxItem Content="ProducciÃ³n" Tag="Produccion"/>
                    </ComboBox>

                    <CheckBox Foreground="{StaticResource TextPrimary}"
                              FontFamily="Segoe UI" FontSize="12"
                              IsChecked="{Binding ModoOfflineForzado}"
                              Content="Forzar modo offline (no enviar al SIN)"
                              Margin="0,0,0,8"/>

                    <TextBlock FontFamily="Segoe UI" FontSize="11"
                               Foreground="{StaticResource TextSecondary}"
                               TextWrapping="Wrap"
                               Text="En modo offline las facturas se guardan localmente y se sincronizan cuando haya conexiÃ³n."/>
                </StackPanel>
            </Border>

            <!-- Guardar -->
            <StackPanel Orientation="Horizontal">
                <Button Style="{StaticResource BtnPrimary}" Height="44" Padding="24,0"
                        Margin="0,0,12,0"
                        Content="ðŸ’¾ Guardar ConfiguraciÃ³n"
                        Command="{Binding GuardarConfiguracionCommand}"/>

                <Border Padding="14,0" CornerRadius="6" VerticalAlignment="Center"
                        Visibility="{Binding GuardadoExitoso,
                            Converter={StaticResource BoolToVisibility}}"
                        Background="{StaticResource AccentMuted}">
                    <TextBlock Text="{Binding MensajeEstado}"
                               Foreground="{StaticResource Accent}"
                               FontFamily="Segoe UI" FontSize="12"
                               VerticalAlignment="Center"/>
                </Border>
            </StackPanel>

        </StackPanel>
    </ScrollViewer>
</UserControl>